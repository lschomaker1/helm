<h1 class="mb-4">Customers</h1>

<div class="card">
  <div class="card-body p-0">
    <table class="table table-striped table-hover mb-0">
      <thead>
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Contact</th>
          <th>Phone</th>
          <th>Email</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @customers.each do |customer| %>
          <tr>
            <td><%= customer.id %></td>
            <td><%= customer.name || "—" %></td>
            <td><%= customer.respond_to?(:contact_name) ? customer.contact_name : "—" %></td>
            <td><%= customer.respond_to?(:phone) ? customer.phone : "—" %></td>
            <td><%= customer.respond_to?(:email) ? customer.email : "—" %></td>
            <td class="text-end">
              <%= link_to "View",
                          customer_path(customer),
                          class: "btn btn-sm btn-outline-primary me-2" %>

              <% if policy(customer).destroy? %>
                <form action="<%= customer_path(customer) %>"
                      method="post"
                      class="d-inline"
                      onsubmit="return confirm('Are you sure?');">
                  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
                  <%= hidden_field_tag :_method, "delete" %>

                  <button type="submit"
                          class="btn btn-sm btn-outline-danger"
                          title="Delete">
                    <i class="bi bi-trash"></i>
                  </button>
                </form>
              <% end %>
            </td>



          </tr>
        <% end %>

        <% if @customers.empty? %>
          <tr>
            <td colspan="6" class="text-center py-4 text-muted">
              No customers yet.
              <%= link_to "Add customer", new_customer_path, class: "ms-2" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<div class="mt-3">
  <%= link_to "New Customer", new_customer_path, class: "btn btn-primary" %>
</div>
